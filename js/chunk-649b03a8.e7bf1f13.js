(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-649b03a8"],{"0029":function(t,e,s){},2375:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"spinner"},[s("div",{staticClass:"bouncing-loader"},[s("div"),s("div"),s("div")])])}],n=(s("d0b5"),s("2877")),r={},o=Object(n["a"])(r,a,i,!1,null,"03284d6c",null);e["a"]=o.exports},"5d4b":function(t,e,s){"use strict";s("0029")},6783:function(t,e,s){"use strict";s("a4d3"),s("e01a");var a=s("b132");e["a"]={getTweets:function(){return a["b"].get("/tweets")},postTweets:function(t){var e=t.description;return a["b"].post("/tweets/",{description:e})},postLike:function(t){return a["b"].post("/tweets/".concat(t,"/like"))},postUnlike:function(t){return a["b"].post("/tweets/".concat(t,"/unlike"))},getSingleTweet:function(t){var e=t.tweetId;return a["b"].get("/tweets/".concat(e))}}},"703e":function(t,e,s){},"7d7e":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweets-container"},[s("header",{staticClass:"tweets__header"},[t._m(0),s("div",{staticClass:"tweets__header__post"},[s("router-link",{staticClass:"tweets__header__post--avatar",attrs:{to:"/home/"+t.currentUser.id}},[s("img",{attrs:{src:t.currentUser.avatar||"https://i.pinimg.com/originals/1f/7c/70/1f7c70f9b5b5f0e1972a4888468ed84c.jpg",alt:"avatar","aria-label":"avatar"}})]),s("div",{staticClass:"tweets__header__post__wrapper"},[s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],attrs:{name:"new-post",id:"new-post",rows:"3",placeholder:"有什麼新鮮事？",autofocus:""},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("button",{staticClass:"active",class:{disabled:t.isProcessing},attrs:{disabled:t.isProcessing},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.sendTweet(t.text)}}},[t._v(" 推文 ")])])],1)]),s("hr",{staticClass:"tweets-line"}),[t.isLoading?s("Spinner"):t._l(t.tweets,(function(t){return s("Tweet",{key:t.id,attrs:{"initial-tweet":t}})}))]],2)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tweets__header__title"},[s("h1",[t._v("首頁")])])}],n=s("1da1"),r=s("5530"),o=(s("96cf"),s("d81d"),s("b17a")),c=s("2375"),u=s("2f62"),l=s("b132"),w=s("6783"),d={name:"tweets",components:{Tweet:o["a"],Spinner:c["a"]},data:function(){return{tweets:[],text:"",isProcessing:!1,isLoading:!0}},created:function(){this.fetchTweets()},computed:Object(r["a"])({},Object(u["b"])(["currentUser","tweet"])),watch:{tweet:function(){this.sendTweet(this.tweet)}},sockets:{ONLINE_LIST_UPDATE:function(t){this.$store.commit("SOCKET_storeUserList",t)}},methods:{fetchTweets:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoading=!0,e.next=4,w["a"].getTweets();case 4:if(s=e.sent,a=s.data,"error"!==a.status){e.next=8;break}throw new Error(a.message);case 8:t.tweets=a.map((function(t){return Object(r["a"])({},t)})),t.isLoading=!1,e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),t.isLoading=!1,l["a"].fire({icon:"error",title:"無法獲取推文，請稍後再嘗試"});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},sendTweet:function(t){t?t.length>140?l["a"].fire({icon:"warning",title:"超過推文字數限制"}):(this.updateTweets(t),this.text=""):l["a"].fire({icon:"warning",title:"內容不可空白"})},updateTweets:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var a,i,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,e.isProcessing=!0,e.isLoading=!0,a=t,s.next=6,w["a"].postTweets({description:a});case 6:if(i=s.sent,n=i.data,"success"===n.status){s.next=10;break}throw new Error(n.message);case 10:e.fetchTweets(),e.isProcessing=!1,e.isLoading=!1,s.next=20;break;case 15:s.prev=15,s.t0=s["catch"](0),e.isProcessing=!1,e.isLoading=!1,l["a"].fire({icon:"error",title:"推文失敗，請稍後再試"});case 20:case"end":return s.stop()}}),s,null,[[0,15]])})))()}}},p=d,f=(s("ad5a"),s("2877")),h=Object(f["a"])(p,a,i,!1,null,null,null);e["default"]=h.exports},8675:function(t,e,s){},ad5a:function(t,e,s){"use strict";s("8675")},b17a:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"tweet-container"},[s("div",{staticClass:"tweet"},[s("router-link",{staticClass:"tweet__avatar",attrs:{to:"/home/"+t.tweet.User.id}},[s("img",{staticClass:"tweet__avatar--img",attrs:{src:t.tweet.User.avatar||"https://i.pinimg.com/originals/1f/7c/70/1f7c70f9b5b5f0e1972a4888468ed84c.jpg",alt:"avatar","aria-label":"avatar"}})]),s("div",{staticClass:"tweet__info"},[s("div",{staticClass:"tweet__info-postBy"},[s("router-link",{attrs:{to:"/home/"+t.tweet.User.id}},[s("span",{staticClass:"name"},[t._v(t._s(t.tweet.User.name||"NoName")+" ")]),s("span",{staticClass:"account"},[t._v("@"+t._s(t.tweet.User.account)+"・")])]),s("router-link",{attrs:{to:"/home/tweets/"+t.tweet.id}},[s("span",{staticClass:"timeStamp"},[t._v(t._s(t._f("fromNow")(t.tweet.createdAt)))])])],1),s("router-link",{attrs:{to:"/home/tweets/"+t.tweet.id}},[s("p",{staticClass:"tweet__info-description"},[t._v(t._s(t.tweet.description))])]),s("div",{staticClass:"tweet__info-count"},[s("span",{staticClass:"tweet__info-count--reply",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleReplyModal.apply(null,arguments)}}},[s("svg",{attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M8.77881 1.40127L6.18631 1.39502H6.18506C3.45131 1.39502 1.31006 3.53689 1.31006 6.27127C1.31006 8.83252 3.30131 10.775 5.97568 10.8775V13.27C5.97568 13.3375 6.00318 13.4488 6.05068 13.5219C6.13943 13.6625 6.29068 13.7388 6.44568 13.7388C6.53193 13.7388 6.61881 13.715 6.69693 13.665C6.86193 13.56 10.7426 11.0775 11.7519 10.2238C12.9407 9.21752 13.6519 7.74252 13.6538 6.27877V6.26814C13.6501 3.53877 11.5101 1.40127 8.77881 1.40064V1.40127ZM11.1457 9.50877C10.4369 10.1088 8.10693 11.6369 6.91318 12.4106V10.4188C6.91318 10.16 6.70381 9.95002 6.44443 9.95002H6.19693C3.90943 9.95002 2.24818 8.40252 2.24818 6.27127C2.24818 4.06252 3.97818 2.33252 6.18568 2.33252L8.77756 2.33877H8.77881C10.9863 2.33877 12.7163 4.06752 12.7176 6.27377C12.7157 7.46752 12.1288 8.67627 11.1463 9.50877H11.1457Z",fill:"#657786"}})]),s("span",{staticClass:"tweet__info-count--replyNumber"},[t._v(t._s(t.tweet.replyCounts))])]),s("span",{staticClass:"tweet__info-count--like",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleLikeModal(t.tweet.id,t.tweet.isLike)}}},[s("svg",{directives:[{name:"show",rawName:"v-show",value:!t.tweet.isLike,expression:"!tweet.isLike"}],attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M7.5 13.5239H7.49125C5.87687 13.4939 1.21875 9.28514 1.21875 5.29889C1.21875 3.38389 2.79687 1.70264 4.59562 1.70264C6.02687 1.70264 6.98937 2.69014 7.49937 3.40889C8.00812 2.69139 8.97062 1.70264 10.4025 1.70264C12.2025 1.70264 13.78 3.38389 13.78 5.29951C13.78 9.28451 9.12125 13.4933 7.50687 13.5226H7.5V13.5239ZM4.59625 2.64076C3.29625 2.64076 2.15687 3.88326 2.15687 5.30014C2.15687 8.88764 6.55312 12.5476 7.50062 12.5864C8.44937 12.5476 12.8444 8.88826 12.8444 5.30014C12.8444 3.88326 11.705 2.64076 10.405 2.64076C8.825 2.64076 7.9425 4.47576 7.935 4.49389C7.79125 4.84514 7.2125 4.84514 7.06812 4.49389C7.05937 4.47514 6.1775 2.64076 4.59687 2.64076H4.59625Z",fill:"#657786"}})]),s("svg",{directives:[{name:"show",rawName:"v-show",value:t.tweet.isLike,expression:"tweet.isLike"}],attrs:{width:"22",height:"20",viewBox:"0 0 22 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{d:"M11 19.6381H10.986C8.40295 19.5901 0.949951 12.8561 0.949951 6.47812C0.949951 3.41412 3.47495 0.724121 6.35295 0.724121C8.64295 0.724121 10.183 2.30412 10.999 3.45412C11.813 2.30612 13.353 0.724121 15.644 0.724121C18.524 0.724121 21.048 3.41412 21.048 6.47912C21.048 12.8551 13.594 19.5891 11.011 19.6361H11V19.6381Z",fill:"#E0245E"}})]),s("span",[t._v(t._s(t.tweet.likeCounts))])])])],1)],1)])])},i=[],n=s("1da1"),r=s("5530"),o=(s("96cf"),s("a4d3"),s("e01a"),s("6783")),c=s("b132"),u={mixins:[c["c"]],name:"Tweet",props:{initialTweet:{type:Object,required:!0}},data:function(){return{tweet:{id:0,description:"",createdAt:"",User:{id:-1,account:"",name:"",avatar:""},isLike:!1,likeCounts:0,replyCounts:0}}},created:function(){this.fetchTweet()},methods:{toggleReplyModal:function(){this.$store.commit("toggleModal",{reply:"reply",id:this.tweet.id,description:this.tweet.description,createdAt:this.tweet.createdAt,User:Object(r["a"])({},this.tweet.User)}),this.tweet.replyCounts++},toggleLikeModal:function(t,e){var s=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i,n,u,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!e){a.next=11;break}return a.next=4,o["a"].postUnlike(t);case 4:if(i=a.sent,n=i.data,"error"!==n.status){a.next=8;break}throw new Error(n.message);case 8:c["a"].fire({icon:"success",title:"成功取消喜歡"}),a.next=18;break;case 11:return a.next=13,o["a"].postLike(t);case 13:if(u=a.sent,l=u.data,"error"!==l.status){a.next=17;break}throw new Error(l.message);case 17:c["a"].fire({icon:"success",title:"成功喜歡一則推文"});case 18:s.tweet=Object(r["a"])(Object(r["a"])({},s.tweet),{},{isLike:!s.tweet.isLike}),e?s.tweet.likeCounts--:s.tweet.likeCounts++,a.next=25;break;case 22:a.prev=22,a.t0=a["catch"](0),c["a"].fire({icon:"error",title:"無法切換喜歡狀態，請稍後再嘗試"});case 25:case"end":return a.stop()}}),a,null,[[0,22]])})))()},fetchTweet:function(){this.tweet=Object(r["a"])({},this.initialTweet)}},watch:{initialTweet:function(t){this.tweet=Object(r["a"])(Object(r["a"])({},this.tweet),t)}}},l=u,w=(s("5d4b"),s("2877")),d=Object(w["a"])(l,a,i,!1,null,null,null);e["a"]=d.exports},d0b5:function(t,e,s){"use strict";s("703e")},d81d:function(t,e,s){"use strict";var a=s("23e7"),i=s("b727").map,n=s("1dde"),r=n("map");a({target:"Array",proto:!0,forced:!r},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-649b03a8.e7bf1f13.js.map