(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-025606c4"],{"4b52":function(t,e,o){"use strict";o("e71f")},8845:function(t,e,o){"use strict";var n=o("b132");e["a"]={getFollowings:function(t){return n["b"].get("/users/".concat(t,"/followings"))},getFollowers:function(t){return n["b"].get("/users/".concat(t,"/followers"))},getTopFollow:function(){return n["b"].get("/followships/top")},addFollow:function(t){return n["b"].post("/followships",{id:t})},cancelFollow:function(t){return n["b"].delete("/followships/".concat(t))}}},b9da:function(t,e,o){},bece:function(t,e,o){"use strict";o("b9da")},d81d:function(t,e,o){"use strict";var n=o("23e7"),s=o("b727").map,a=o("1dde"),r=a("map");n({target:"Array",proto:!0,forced:!r},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},e71f:function(t,e,o){},f4ef:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"twitter-container"},[o("router-view",{attrs:{"to-change-follow-status":t.toChangeFollowStatus},on:{"after-toggle-follow":t.afterToggleFollow}}),o("Top",{attrs:{"to-change-follow-status":t.toChangeFollowStatus},on:{"after-toggle-follow":t.afterToggleFollow}})],1)},s=[],a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"top-container"},[o("main",{staticClass:"top"},[t._m(0),t._l(t.tops,(function(e){return o("div",{key:e.id,staticClass:"top__user"},[o("router-link",{attrs:{to:"/home/"+e.id}},[o("div",{staticClass:"top__user-avatar"},[o("img",{staticClass:"top__user-avatar--img",attrs:{src:e.avatar}})])]),o("div",{staticClass:"top__user-info"},[o("div",[o("router-link",{attrs:{to:"/home/"+e.id}},[o("p",{staticClass:"top__user-info--name"},[t._v(" "+t._s(e.name)+" ")])]),o("router-link",{attrs:{to:"/home/"+e.id}},[o("p",{staticClass:"top__user-info--account"},[t._v(" @"+t._s(e.account)+" ")])])],1),e.id!==t.currentUser.id?o("button",{staticClass:"top__user-info--follow",class:{active:e.isFollowing,disabled:e.isProcessing},attrs:{disabled:e.isProcessing},on:{click:function(o){o.stopPropagation(),o.preventDefault(),e.isFollowing?t.cancelFollow(e.id):t.addFollow(e.id)}}},[t._v(" "+t._s(e.isFollowing?"正在跟隨":"跟隨")+" ")]):t._e()])],1)}))],2)])},r=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("header",{staticClass:"top__header"},[o("p",{staticClass:"top__header-title"},[t._v("Popular")])])}],i=o("1da1"),c=o("5530"),l=(o("96cf"),o("d81d"),o("b0c0"),o("b132")),u=o("8845"),f=o("2f62"),p={name:"Top",props:{toChangeFollowStatus:{type:Array,default:function(){return[]}}},data:function(){return{tops:[]}},computed:Object(c["a"])({},Object(f["b"])(["currentUser"])),watch:{toChangeFollowStatus:{handler:function(){var t=this;this.tops=this.tops.map((function(e){return e.id===t.toChangeFollowStatus[0]?Object(c["a"])(Object(c["a"])({},e),{},{isFollowing:t.toChangeFollowStatus[1]}):Object(c["a"])({},e)}))},deep:!0}},methods:{fetchTops:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var o,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u["a"].getTopFollow();case 3:o=e.sent,n=o.data,t.tops=n.results.map((function(t){return Object(c["a"])(Object(c["a"])({},t),{},{name:t.name||"NoName",avatar:t.avatar||"https://i.pinimg.com/originals/1f/7c/70/1f7c70f9b5b5f0e1972a4888468ed84c.jpg",isProcessing:!1})})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),l["a"].fire({icon:"error",title:"無法讀取到熱門使用者資訊，請稍後再試"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},toggleProcessing:function(t){this.tops=this.tops.map((function(e){return e.id===t?Object(c["a"])(Object(c["a"])({},e),{},{isProcessing:!e.isProcessing}):Object(c["a"])({},e)}))},addFollow:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function o(){var n,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,e.toggleProcessing(t),o.next=4,u["a"].addFollow(t);case 4:if(n=o.sent,s=n.data,"success"===s.status){o.next=8;break}throw new Error(s.message);case 8:e.tops=e.tops.map((function(e){return e.id===t?Object(c["a"])(Object(c["a"])({},e),{},{isFollowing:!0,isProcessing:!e.isProcessing}):Object(c["a"])({},e)})),e.$emit("after-toggle-follow",[t,!0]),l["a"].fire({icon:"success",title:"跟隨成功！"}),o.next=17;break;case 13:o.prev=13,o.t0=o["catch"](0),e.toggleProcessing(t),l["a"].fire({icon:"error",title:"無法跟隨或取消跟隨該使用者，請稍後再試"});case 17:case"end":return o.stop()}}),o,null,[[0,13]])})))()},cancelFollow:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function o(){var n,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,e.toggleProcessing(t),o.next=4,u["a"].cancelFollow(t);case 4:n=o.sent,s=n.data,e.tops=e.tops.map((function(e){return e.id===t?Object(c["a"])(Object(c["a"])({},e),{},{isFollowing:!1,isProcessing:!e.isProcessing}):Object(c["a"])({},e)})),l["a"].fire({icon:"success",title:"".concat(s.message,"!")}),e.$emit("after-toggle-follow",[t,!1]),o.next=15;break;case 11:o.prev=11,o.t0=o["catch"](0),e.toggleProcessing(t),l["a"].fire({icon:"error",title:"無法跟隨或取消跟隨該使用者，請稍後再試"});case 15:case"end":return o.stop()}}),o,null,[[0,11]])})))()}},created:function(){this.fetchTops()}},g=p,d=(o("bece"),o("2877")),w=Object(d["a"])(g,a,r,!1,null,null,null),h=w.exports,b={components:{Top:h},data:function(){return{toChangeFollowStatus:[]}},methods:{afterToggleFollow:function(t){this.toChangeFollowStatus=t}}},m=b,v=(o("4b52"),Object(d["a"])(m,n,s,!1,null,null,null));e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-025606c4.4dcbda94.js.map