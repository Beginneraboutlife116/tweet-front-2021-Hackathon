(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9aef8dc4"],{"06c3":function(t,s,e){},3056:function(t,s,e){"use strict";e("5d23")},"5d23":function(t,s,e){},bf48:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"public-container"},[e("div",{staticClass:"users-container"},[e("header",{staticClass:"users__header"},[e("p",{staticClass:"users__title"},[t._v("上線使用者("+t._s(t.allOnlineUsers.length)+")")])]),t._l(t.allOnlineUsers,(function(t){return e("User",{key:t.id,attrs:{user:t}})}))],2),e("div",{staticClass:"chatroom-container"},[t._m(0),e("main",{staticClass:"chatroom__box"},t._l(t.chatroomList,(function(t,s){return e("ChatMsg",{key:s,attrs:{msg:t}})})),1),e("footer",{staticClass:"chatroom__send"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],staticClass:"chatroom__send-input",attrs:{type:"text",placeholder:"輸入訊息..."},domProps:{value:t.text},on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.sendMessage.apply(null,arguments)},input:function(s){s.target.composing||(t.text=s.target.value.trim())},blur:function(s){return t.$forceUpdate()}}}),e("button",{staticClass:"chatroom__send-btn",on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.sendMessage.apply(null,arguments)}}},[e("ChatBoxButtonSvg")],1)])])])},r=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("header",{staticClass:"chatroom__header"},[e("p",{staticClass:"chatroom__title"},[t._v("公開聊天室")])])}],i=e("1da1"),n=e("5530"),c=(e("96cf"),e("b0c0"),function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"user"},[e("div",{staticClass:"user__avatar"},[e("router-link",{attrs:{to:{name:"profile-tweets",params:{userId:t.user.id}}}},[e("img",{staticClass:"user__avatar-img",attrs:{src:t.user.avatar||"https://i.pinimg.com/originals/1f/7c/70/1f7c70f9b5b5f0e1972a4888468ed84c.jpg",alt:""}})])],1),e("p",{staticClass:"user__info"},[e("span",{staticClass:"user__info-name"},[e("router-link",{attrs:{to:{name:"profile-tweets",params:{userId:t.user.id}}}},[t._v(" "+t._s(t.user.name)+" ")])],1),e("span",{staticClass:"user__info-account"},[e("router-link",{attrs:{to:{name:"profile-tweets",params:{userId:t.user.id}}}},[t._v(" @"+t._s(t.user.account)+" ")])],1)])])}),o=[],u={name:"user",props:{user:{type:Object,default:function(){}}}},l=u,m=(e("3056"),e("2877")),_=Object(m["a"])(l,c,o,!1,null,null,null),f=_.exports,p=function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.msg.status?e("div",{staticClass:"noti"},[e("span",{staticClass:"noti__name"},[t._v(" "+t._s(t.msg.name)+" ")]),e("span",{staticClass:"noti__action"},[t._v(" "+t._s("on"===t.msg.status?"上線":"離線")+" ")])]):e("div",{staticClass:"chat-container"},[t.msg.user.id===t.currentUser.id?e("div",{staticClass:"out"},[e("div",{staticClass:"out__info"},[e("p",{staticClass:"out__text"},[t._v(" "+t._s(t.msg.message)+" ")]),e("p",{staticClass:"out__timeStamp"},[t._v(" "+t._s(t._f("absoluteTimeShort")(t.msg.timeStamp))+" ")])]),e("div",{staticClass:"out__avatar"},[e("router-link",{attrs:{to:{name:"profile-tweets",params:{userId:t.msg.user.id}}}},[e("img",{staticClass:"out__avatar-img",attrs:{src:t.msg.user.avatar||"https://i.pinimg.com/originals/1f/7c/70/1f7c70f9b5b5f0e1972a4888468ed84c.jpg",alt:""}})])],1)]):e("div",{staticClass:"in"},[e("div",{staticClass:"in__avatar"},[e("router-link",{attrs:{to:{name:"profile-tweets",params:{userId:t.msg.user.id}}}},[e("img",{staticClass:"in__avatar-img",attrs:{src:t.msg.user.avatar||"https://i.pinimg.com/originals/1f/7c/70/1f7c70f9b5b5f0e1972a4888468ed84c.jpg",alt:""}})])],1),e("div",{staticClass:"in__info"},[e("p",{staticClass:"in__text"},[t._v(" "+t._s(t.msg.message)+" ")]),e("p",{staticClass:"in__timeStamp"},[t._v(" "+t._s(t._f("absoluteTimeShort")(t.msg.timeStamp))+" ")])])])])},d=[],h=e("b132"),g={name:"chat",mixins:[h["c"]],props:{msg:{type:Object,required:!0}},computed:{currentUser:function(){return this.$store.state.currentUser}}},v=g,C=(e("c07f"),Object(m["a"])(v,p,d,!1,null,null,null)),b=C.exports,x=e("cbd1"),w=e("4cce"),k={components:{User:f,ChatMsg:b,ChatBoxButtonSvg:x["a"]},data:function(){return{chatroomList:[],text:""}},computed:{allOnlineUsers:function(){return this.$store.state.allOnlineUsers},userStatus:function(){return this.$store.state.userStatus},userMsg:function(){return this.$store.state.userMsg}},created:function(){this.loginMessageHistory(),this.$socket.emit("USER_ONLINE",{user:Object(n["a"])(Object(n["a"])({},this.$store.state.currentUser),{},{name:""})})},methods:{sendMessage:function(){if(this.text){var t={id:this.$store.state.currentUser.id,name:this.$store.state.currentUser.name,avatar:this.$store.state.currentUser.avatar};this.$socket.emit("MESSAGE",{user:t,message:this.text,timeStamp:new Date}),this.text=""}},loginMessageHistory:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var e,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,w["a"].getMessageHistory();case 3:e=s.sent,a=e.data,t.chatroomList=a,s.next=11;break;case 8:s.prev=8,s.t0=s["catch"](0),h["a"].fire({icon:"fire",title:"無法讀取歷史訊息"});case 11:case"end":return s.stop()}}),s,null,[[0,8]])})))()}},watch:{userStatus:{handler:function(){this.userStatus.name&&this.chatroomList.unshift(this.userStatus)},deep:!0},userMsg:{handler:function(){this.chatroomList.unshift(this.userMsg)},deep:!0}},sockets:{ONLINE_LIST_UPDATE:function(t){this.$store.commit("SOCKET_storeUserList",t)}}},S=k,L=(e("f333"),Object(m["a"])(S,a,r,!1,null,null,null));s["default"]=L.exports},c07f:function(t,s,e){"use strict";e("ec7a")},cbd1:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("svg",{attrs:{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M19.1301 9.35798L1.61406 0.107979C1.32406 -0.0440207 0.97406 0.00597923 0.74106 0.233979C0.51106 0.459979 0.44806 0.810979 0.59106 1.10198L4.95306 10.022L0.59106 18.942C0.44806 19.234 0.51106 19.585 0.74106 19.81C0.88606 19.95 1.07406 20.022 1.26406 20.022C1.38406 20.022 1.50406 19.994 1.61406 19.935L19.1311 10.685C19.3761 10.555 19.5311 10.299 19.5311 10.021C19.5311 9.74298 19.3761 9.48898 19.1311 9.35898L19.1301 9.35798ZM2.94806 2.50998L15.7521 9.27198H6.25506L2.94806 2.51198V2.50998ZM6.25506 10.77H15.7531L2.94806 17.535L6.25506 10.772V10.77Z",fill:"#FF6600"}})])},r=[],i=e("2877"),n={},c=Object(i["a"])(n,a,r,!1,null,null,null);s["a"]=c.exports},ec7a:function(t,s,e){},f333:function(t,s,e){"use strict";e("06c3")}}]);
//# sourceMappingURL=chunk-9aef8dc4.b90b6c5d.js.map