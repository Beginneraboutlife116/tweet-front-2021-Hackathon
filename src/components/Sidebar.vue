<template>
  <div class="sidebar-container">
    <nav class="sidebar">
      <router-link
        :to="
          this.currentUser.role === 'admin'
            ? { name: 'admin-tweets' }
            : { name: 'home' }
        "
      >
        <svg
          class="sidebar__logo"
          width="30"
          height="30"
          viewBox="0 0 30 30"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M19.2746 13.8535C19.2746 13.8535 13.6744 22.9339 9.08306 22.9339C1.0522 22.9339 8.53639 5.63525 14.3936 5.63525C18.4806 5.63525 19.2746 13.8535 19.2746 13.8535Z"
            fill="#FF6600"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M25.9293 25.2728C24.334 26.9704 22.3649 28.2731 20.1784 29.0774C17.9919 29.8818 15.648 30.1658 13.3326 29.9069C11.0172 29.648 8.79399 28.8533 6.83923 27.5859C4.88446 26.3184 3.25192 24.613 2.07104 22.6049C3.39867 24.4106 5.65044 25.6144 8.85237 25.6144C16.7401 25.6144 21.2175 19.4849 21.2175 19.4849C21.2175 19.4849 21.6048 24.3293 25.9196 25.2728H25.9293Z"
            fill="#FF6600"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M28.2916 8.05908C29.4721 10.3147 30.0585 12.8339 29.9953 15.379C29.9321 17.924 29.2214 20.411 27.9304 22.6053C26.9092 22.0326 26.1543 21.0814 25.8283 19.957L24.1167 14.8295L28.2916 8.05908Z"
            fill="#FF6600"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M15.0024 0.0130266C18.7639 0.0105251 22.3885 1.42411 25.1548 3.97249L22.3141 8.55661C21.2858 5.88226 19.1968 3.20468 15.1325 3.20468C6.80881 3.20468 0.63923 12.2916 0.63923 17.9884C0.637396 18.7252 0.731462 19.459 0.919069 20.1715C0.0866864 17.9044 -0.185961 15.4699 0.124289 13.0749C0.434539 10.6798 1.31852 8.39507 2.7011 6.41479C4.08368 4.43452 5.92399 2.81726 8.06563 1.70044C10.2073 0.583634 12.5869 0.00029138 15.0024 0V0.0130266Z"
            fill="#FF6600"
          />
        </svg>
      </router-link>
      <template v-if="currentUser.role === 'user'">
        <ul>
          <li class="sidebar__link">
            <router-link :to="{ name: 'home' }">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M22.58 7.34986L12.475 1.89686C12.178 1.73686 11.821 1.73686 11.525 1.89686L1.42502 7.34986C0.939018 7.61386 0.758018 8.21986 1.02002 8.70586C1.20002 9.04086 1.54502 9.23086 1.90002 9.23086C2.06002 9.23086 2.22402 9.19286 2.37502 9.11086L3.10902 8.71486L4.69902 19.9649C4.91502 21.1789 6.00902 22.0269 7.35902 22.0269H16.641C17.991 22.0269 19.085 21.1789 19.303 19.9389L20.891 8.71386L21.628 9.11186C22.113 9.37486 22.72 9.19386 22.982 8.70786C23.245 8.22186 23.062 7.61486 22.578 7.35286L22.58 7.34986ZM12 15.4349C10.205 15.4349 8.75002 13.9799 8.75002 12.1849C8.75002 10.3899 10.205 8.93486 12 8.93486C13.795 8.93486 15.25 10.3899 15.25 12.1849C15.25 13.9799 13.795 15.4349 12 15.4349Z"
                  fill="#1C1C1C"
                />
              </svg>
              <span>首頁</span>
            </router-link>
          </li>
          <li class="sidebar__link">
            <router-link
              :to="{
                name: 'notifications',
                params: { userId: currentUser.id }
              }"
            >
              <svg
                width="24"
                height="24"
                viewBox="0 0 20 21"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.697 15.468C19.677 15.452 17.557 13.828 17.594 9.43799C17.614 6.90599 16.782 4.65599 15.247 3.10299C13.872 1.70999 12.01 0.939993 10.005 0.929993H9.99197C7.98798 0.939993 6.12597 1.70999 4.74997 3.10399C3.21597 4.65699 2.38197 6.90599 2.40397 9.43799C2.44097 13.768 0.383975 15.405 0.301975 15.468C0.0419748 15.661 -0.0640253 15.998 0.0369747 16.306C0.138975 16.614 0.426975 16.821 0.748975 16.821H5.66897C5.77098 19.131 7.66597 20.981 9.99897 20.981C12.332 20.981 14.225 19.131 14.326 16.821H19.248C19.57 16.821 19.858 16.615 19.958 16.307C20.061 16 19.955 15.662 19.695 15.469L19.697 15.468ZM9.99998 19.478C8.49498 19.478 7.26997 18.301 7.17197 16.82H12.828C12.728 18.3 11.505 19.48 9.99998 19.48V19.478ZM2.37997 15.32C3.11997 14.188 3.92797 12.292 3.90397 9.42399C3.88597 7.26399 4.54797 5.44199 5.81697 4.15699C6.90997 3.04999 8.39698 2.43699 9.99998 2.42999C11.603 2.43799 13.087 3.04999 14.18 4.15799C15.45 5.44299 16.113 7.26399 16.095 9.42499C16.071 12.293 16.88 14.19 17.62 15.321H2.37997V15.32Z"
                  fill="#1C1C1C"
                />
              </svg>
              <RedDotSvg v-if="false" />
              <span>通知</span>
            </router-link>
          </li>
          <li class="sidebar__link">
            <router-link
              :to="{
                name: 'public',
                params: { userId: currentUser.id }
              }"
            >
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.25 3.01801H4.75C3.233 3.01801 2 4.25201 2 5.77001V18.265C2 19.783 3.233 21.018 4.75 21.018H19.25C20.767 21.018 22 19.783 22 18.265V5.77001C22 4.25201 20.767 3.01801 19.25 3.01801ZM4.75 4.51801H19.25C19.94 4.51801 20.5 5.07801 20.5 5.76801V6.48201L12.45 11.849C12.177 12.029 11.824 12.031 11.55 11.847L3.5 6.48201V5.76801C3.5 5.07801 4.06 4.51801 4.75 4.51801ZM19.25 19.516H4.75C4.06 19.516 3.5 18.956 3.5 18.266V8.24001L10.74 13.07C11.123 13.326 11.562 13.454 12 13.454C12.44 13.454 12.877 13.326 13.26 13.071L20.5 8.24101V18.263C20.5 18.953 19.94 19.513 19.25 19.513V19.516Z"
                  fill="black"
                />
              </svg>
              <RedDotSvg v-if="publicNoti" />
              <span>公開聊天室</span>
            </router-link>
          </li>
          <li class="sidebar__link">
            <router-link
              :to="{
                name: 'private',
                params: { userId: currentUser.id }
              }"
            >
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.25 3.01801H4.75C3.233 3.01801 2 4.25201 2 5.77001V18.265C2 19.783 3.233 21.018 4.75 21.018H19.25C20.767 21.018 22 19.783 22 18.265V5.77001C22 4.25201 20.767 3.01801 19.25 3.01801ZM4.75 4.51801H19.25C19.94 4.51801 20.5 5.07801 20.5 5.76801V6.48201L12.45 11.849C12.177 12.029 11.824 12.031 11.55 11.847L3.5 6.48201V5.76801C3.5 5.07801 4.06 4.51801 4.75 4.51801ZM19.25 19.516H4.75C4.06 19.516 3.5 18.956 3.5 18.266V8.24001L10.74 13.07C11.123 13.326 11.562 13.454 12 13.454C12.44 13.454 12.877 13.326 13.26 13.071L20.5 8.24101V18.263C20.5 18.953 19.94 19.513 19.25 19.513V19.516Z"
                  fill="black"
                />
              </svg>
              <RedDotSvg v-if="privateNotiCount" />
              <span
                >私人訊息<strong class="private-noti" v-if="privateNotiCount">
                  {{ privateNotiCount }}
                </strong></span
              >
            </router-link>
          </li>
          <li class="sidebar__link">
            <router-link
              :to="{
                name: 'profile-tweets',
                params: { userId: currentUser.id }
              }"
            >
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11.9999 11.8158C13.3549 11.8158 14.8719 11.6658 15.8399 10.5598C16.6539 9.62976 16.9179 8.19176 16.6459 6.16776C16.2659 3.34276 14.5289 1.65576 11.9999 1.65576C9.47091 1.65576 7.73391 3.34276 7.35391 6.16976C7.08191 8.19176 7.3459 9.62976 8.1599 10.5598C9.1279 11.6668 10.6449 11.8158 11.9999 11.8158ZM8.83991 6.36776C9.00191 5.16776 9.62691 3.15576 11.9999 3.15576C14.3729 3.15576 14.9979 5.16876 15.1599 6.36776C15.3669 7.91776 15.2169 8.99476 14.7099 9.57276C14.2549 10.0928 13.4439 10.3158 11.9999 10.3158C10.5559 10.3158 9.7449 10.0928 9.28991 9.57276C8.78291 8.99476 8.63291 7.91676 8.83991 6.36776ZM20.2799 19.2358C19.4029 15.7098 15.9979 13.2458 11.9999 13.2458C8.00191 13.2458 4.59691 15.7098 3.71991 19.2358C3.54791 19.9278 3.6919 20.6358 4.1149 21.1758C4.5229 21.6958 5.15491 21.9958 5.84791 21.9958H18.1519C18.8449 21.9958 19.4769 21.6958 19.8849 21.1758C20.3089 20.6358 20.4519 19.9288 20.2789 19.2358H20.2799ZM18.7039 20.2518C18.5779 20.4118 18.3879 20.4978 18.1519 20.4978H5.84791C5.61291 20.4978 5.42191 20.4128 5.29591 20.2518C5.15891 20.0778 5.11591 19.8398 5.17591 19.5978C5.88591 16.7428 8.69291 14.7478 11.9999 14.7478C15.3069 14.7478 18.1139 16.7418 18.8239 19.5978C18.8839 19.8398 18.8409 20.0778 18.7039 20.2518Z"
                  fill="#1C1C1C"
                />
              </svg>
              <span>個人資料</span>
            </router-link>
          </li>
          <li class="sidebar__link">
            <router-link
              :to="{ name: 'setting', params: { userId: currentUser.id } }"
            >
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 8.20996C9.90996 8.20996 8.20996 9.90996 8.20996 12C8.20996 14.09 9.90996 15.79 12 15.79C14.09 15.79 15.79 14.09 15.79 12C15.79 9.90996 14.09 8.20996 12 8.20996ZM12 14.29C10.738 14.29 9.70996 13.264 9.70996 12C9.70996 10.736 10.74 9.70996 12 9.70996C13.26 9.70996 14.29 10.736 14.29 12C14.29 13.264 13.262 14.29 12 14.29Z"
                  fill="#1C1C1C"
                />
                <path
                  d="M12.36 22.375H11.638C10.455 22.375 9.48405 21.487 9.37605 20.311L9.36205 20.164C9.33705 19.877 9.15505 19.631 8.89005 19.52C8.60405 19.4 8.30805 19.455 8.09205 19.635L7.97605 19.732C7.10805 20.457 5.72305 20.395 4.91605 19.592L4.40605 19.082C3.57005 18.242 3.51005 16.928 4.26605 16.022L4.36405 15.904C4.55005 15.682 4.59405 15.381 4.48605 15.117C4.37605 14.845 4.12805 14.663 3.84005 14.637L3.69005 14.623C2.51005 14.516 1.62305 13.543 1.62305 12.361V11.639C1.62305 10.456 2.51105 9.485 3.68705 9.377L3.84305 9.363C4.12805 9.338 4.37305 9.156 4.48505 8.89C4.59505 8.62 4.55005 8.317 4.36505 8.095L4.27105 7.979C3.51405 7.071 3.57305 5.756 4.40805 4.919L4.92005 4.407C5.72405 3.603 7.10805 3.542 7.98005 4.267L8.09605 4.365C8.31405 4.549 8.62405 4.595 8.88605 4.487C9.15605 4.375 9.33805 4.129 9.36305 3.844L9.37705 3.691C9.48405 2.511 10.457 1.625 11.639 1.625H12.361C13.544 1.625 14.515 2.513 14.623 3.689L14.637 3.845C14.662 4.13 14.843 4.375 15.109 4.485C15.386 4.602 15.689 4.547 15.903 4.368L16.023 4.266C16.89 3.543 18.277 3.604 19.083 4.406L19.593 4.918C20.429 5.756 20.489 7.071 19.733 7.978L19.633 8.096C19.445 8.316 19.399 8.618 19.51 8.884C19.622 9.154 19.87 9.334 20.156 9.362L20.308 9.376C21.488 9.483 22.375 10.456 22.375 11.638V12.361C22.375 13.544 21.487 14.515 20.311 14.623L20.156 14.637C19.872 14.661 19.626 14.842 19.516 15.107C19.403 15.379 19.449 15.681 19.633 15.902L19.733 16.022C20.489 16.927 20.429 18.242 19.593 19.082L19.083 19.592C18.276 20.396 16.893 20.456 16.023 19.732L15.908 19.636C15.691 19.453 15.378 19.406 15.118 19.514C14.845 19.628 14.663 19.874 14.638 20.16L14.624 20.31C14.517 21.483 13.544 22.37 12.362 22.37L12.36 22.375ZM8.58705 17.955C8.88705 17.955 9.18005 18.015 9.45705 18.13C10.247 18.458 10.781 19.184 10.857 20.026L10.871 20.173C10.908 20.573 11.238 20.873 11.641 20.873H12.363C12.763 20.873 13.093 20.573 13.131 20.173L13.145 20.025C13.221 19.183 13.755 18.458 14.537 18.133C15.33 17.803 16.233 17.951 16.87 18.483L16.983 18.577C17.161 18.725 17.349 18.757 17.476 18.757C17.682 18.757 17.876 18.677 18.022 18.53L18.532 18.02C18.816 17.736 18.837 17.29 18.58 16.982L18.48 16.862C17.938 16.212 17.803 15.322 18.128 14.539C18.454 13.749 19.18 13.219 20.022 13.142L20.177 13.128C20.574 13.091 20.877 12.761 20.877 12.358V11.636C20.877 11.236 20.574 10.906 20.175 10.868L20.023 10.854C19.177 10.776 18.453 10.244 18.128 9.461C17.802 8.673 17.938 7.783 18.481 7.134L18.581 7.016C18.838 6.706 18.817 6.26 18.533 5.976L18.023 5.466C17.877 5.319 17.683 5.239 17.477 5.239C17.35 5.239 17.162 5.271 16.985 5.419L16.865 5.519C16.231 6.047 15.315 6.189 14.543 5.873C13.755 5.546 13.223 4.821 13.146 3.977L13.132 3.822C13.097 3.425 12.767 3.122 12.365 3.122H11.642C11.242 3.122 10.912 3.425 10.874 3.824L10.86 3.976C10.784 4.819 10.252 5.544 9.47005 5.869C8.68305 6.195 7.77705 6.052 7.14005 5.519L7.02205 5.423C6.84205 5.273 6.65405 5.243 6.52705 5.243C6.32105 5.243 6.12705 5.323 5.98105 5.469L5.46905 5.979C5.18705 6.263 5.16605 6.709 5.42305 7.017L5.52305 7.135C6.06305 7.788 6.20005 8.679 5.87505 9.46C5.54805 10.248 4.82305 10.78 3.98005 10.857L3.82405 10.871C3.42705 10.908 3.12405 11.238 3.12405 11.641V12.363C3.12405 12.763 3.42705 13.093 3.82605 13.131L3.97605 13.145C4.82405 13.223 5.54905 13.757 5.87305 14.541C6.19805 15.327 6.06305 16.216 5.52005 16.866L5.42405 16.981C5.16405 17.291 5.18605 17.737 5.47005 18.021L5.98005 18.531C6.12605 18.678 6.32005 18.758 6.52605 18.758C6.65305 18.758 6.84105 18.728 7.01805 18.578L7.13405 18.482C7.54005 18.146 8.05705 17.958 8.58705 17.958V17.955Z"
                  fill="#1C1C1C"
                />
              </svg>
              <span>設定</span>
            </router-link>
          </li>
        </ul>
      </template>
      <template v-else>
        <ul>
          <li class="sidebar__link">
            <router-link :to="{ name: 'admin-tweets' }">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M22.58 7.34986L12.475 1.89686C12.178 1.73686 11.821 1.73686 11.525 1.89686L1.42502 7.34986C0.939018 7.61386 0.758018 8.21986 1.02002 8.70586C1.20002 9.04086 1.54502 9.23086 1.90002 9.23086C2.06002 9.23086 2.22402 9.19286 2.37502 9.11086L3.10902 8.71486L4.69902 19.9649C4.91502 21.1789 6.00902 22.0269 7.35902 22.0269H16.641C17.991 22.0269 19.085 21.1789 19.303 19.9389L20.891 8.71386L21.628 9.11186C22.113 9.37486 22.72 9.19386 22.982 8.70786C23.245 8.22186 23.062 7.61486 22.578 7.35286L22.58 7.34986ZM12 15.4349C10.205 15.4349 8.75002 13.9799 8.75002 12.1849C8.75002 10.3899 10.205 8.93486 12 8.93486C13.795 8.93486 15.25 10.3899 15.25 12.1849C15.25 13.9799 13.795 15.4349 12 15.4349Z"
                  fill="#1C1C1C"
                />
              </svg>
              <span>推文清單</span>
            </router-link>
          </li>
          <li class="sidebar__link">
            <router-link :to="{ name: 'admin-users' }">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11.9999 11.8158C13.3549 11.8158 14.8719 11.6658 15.8399 10.5598C16.6539 9.62976 16.9179 8.19176 16.6459 6.16776C16.2659 3.34276 14.5289 1.65576 11.9999 1.65576C9.47091 1.65576 7.73391 3.34276 7.35391 6.16976C7.08191 8.19176 7.3459 9.62976 8.1599 10.5598C9.1279 11.6668 10.6449 11.8158 11.9999 11.8158ZM8.83991 6.36776C9.00191 5.16776 9.62691 3.15576 11.9999 3.15576C14.3729 3.15576 14.9979 5.16876 15.1599 6.36776C15.3669 7.91776 15.2169 8.99476 14.7099 9.57276C14.2549 10.0928 13.4439 10.3158 11.9999 10.3158C10.5559 10.3158 9.7449 10.0928 9.28991 9.57276C8.78291 8.99476 8.63291 7.91676 8.83991 6.36776ZM20.2799 19.2358C19.4029 15.7098 15.9979 13.2458 11.9999 13.2458C8.00191 13.2458 4.59691 15.7098 3.71991 19.2358C3.54791 19.9278 3.6919 20.6358 4.1149 21.1758C4.5229 21.6958 5.15491 21.9958 5.84791 21.9958H18.1519C18.8449 21.9958 19.4769 21.6958 19.8849 21.1758C20.3089 20.6358 20.4519 19.9288 20.2789 19.2358H20.2799ZM18.7039 20.2518C18.5779 20.4118 18.3879 20.4978 18.1519 20.4978H5.84791C5.61291 20.4978 5.42191 20.4128 5.29591 20.2518C5.15891 20.0778 5.11591 19.8398 5.17591 19.5978C5.88591 16.7428 8.69291 14.7478 11.9999 14.7478C15.3069 14.7478 18.1139 16.7418 18.8239 19.5978C18.8839 19.8398 18.8409 20.0778 18.7039 20.2518Z"
                  fill="#1C1C1C"
                />
              </svg>
              <span>使用者清單</span>
            </router-link>
          </li>
        </ul>
      </template>
      <button
        class="active sidebar__button"
        @click.stop.prevent="$store.commit('toggleModal', 'tweet')"
        v-if="currentUser.role === 'user'"
      >
        推文
      </button>
      <span class="sidebar--logout" @click.stop.prevent="logout">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M11 16L7 12M7 12L11 8M7 12H21M16 16V17C16 17.7956 15.6839 18.5587 15.1213 19.1213C14.5587 19.6839 13.7956 20 13 20H6C5.20435 20 4.44129 19.6839 3.87868 19.1213C3.31607 18.5587 3 17.7956 3 17V7C3 6.20435 3.31607 5.44129 3.87868 4.87868C4.44129 4.31607 5.20435 4 6 4H13C13.7956 4 14.5587 4.31607 15.1213 4.87868C15.6839 5.44129 16 6.20435 16 7V8"
            stroke="black"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        <span>登出</span>
      </span>
    </nav>
  </div>
</template>

<script>
import { mapState } from 'vuex'
import RedDotSvg from './../components/RedDotSvg.vue'

export default {
  name: 'Sidebar',
  components: {
    RedDotSvg
  },
  data () {
    return {
      // TODO: 之後要修改這個publicNoti，因為如果更改route，會直接消失不見，但使用者並未點擊公開聊天室
      publicNoti: false
    }
  },
  methods: {
    logout () {
      this.$socket.emit('USER_OFFLINE', {
        id: this.currentUser.id,
        name: this.currentUser.name
      })
      this.$store.commit('revokeAuthentication')
      this.$router.push('/signin')
      setTimeout(() => {
        this.$socket.disconnect()
      }, 1000)
    },
    requestSnapShot () {
      const data = { ...this.subscribedRooms }
      for (const key in data) {
        const currentUserIdIndex = data[key].indexOf(this.currentUser.id)
        data[key] = this.subscribedRooms[key][1 - currentUserIdIndex]
      }
      this.$socket.emit('GET_ROOM_SNAPSHOT', data)
    }
  },
  computed: {
    ...mapState({
      receiver: (state) => state.private.receiver,
      privateNotiCount: (state) => state.private.privateNotiCount,
      currentUser: (state) => state.currentUser,
      userMsg: (state) => state.userMsg,
      subscribedRooms: (state) => state.private.subscribedRooms
    })
  },
  sockets: {
    MESSAGE_UPDATE (data) {
      this.$store.commit('SOCKET_storeMessage', data)
    },
    NEW_ROOM_MESSAGE (saveMessage) {
      console.log('NEW_ROOM_MESSAGE: ', saveMessage)
      this.$store.commit('private/increaseNoti')
      this.$store.commit('private/updateMessagesToRoomsArray', saveMessage)
    },
    ROOM_CREATED (data) {
      console.log('ROOM_CREATE: ', data)
      if (
        !this.subscribedRooms[data.room] &&
        data.users.includes(this.currentUser.id)
      ) {
        this.$socket.emit('SUBSCRIBE_ROOM', data.room)
        this.$store.commit('private/subscribeRoom', data)
        this.$store.commit('private/setRoomId', data.room)
      }
    },
    SUBSCRIBED_ROOM (data) {
      console.log('subscribe room: ', data)
      this.$store.commit('private/subscribeRoom', data)
      this.requestSnapShot()
    },
    ROOM_SNAPSHOT (snapShots) {
      // FIXME: snapShots需要幫忙排序
      // FIXME: 幫我清空一下空房間資料><
      console.log('ROOM_SNAPSHOT from sidebar: ', snapShots)
      let unreadMessageNum = 0
      snapShots.forEach((snapShot) => {
        if (!snapShot.isRead && snapShot.ReceiverId === this.currentUser.id) {
          unreadMessageNum++
        }
        this.$store.commit('private/updateMessagesToRoomsArray', snapShot)
      })
      this.$store.commit('private/recordUnreadMessageNumber', unreadMessageNum)
    }
  },
  watch: {
    userMsg: {
      handler () {
        if (!this.$route.path.includes('public')) {
          this.publicNoti = true
        } else {
          this.publicNoti = false
        }
      },
      deep: true
    }
  },
  created () {
    console.log('subscribe to all room from sidebar')
    this.$socket.emit('SUBSCRIBE_TO_ALL_ROOM', this.currentUser.id)
  }
}
</script>
<style lang="scss">
.router-link-exact-active {
  span {
    color: var(--main-color);
  }
  svg {
    path {
      fill: var(--main-color);
    }
  }
}
.sidebar-container {
  flex: 0 26.25%;
  display: flex;
  justify-content: flex-end;
  padding: 0 5.5rem 0 0;
}
.sidebar {
  position: relative;
  flex: 0 21rem;
  height: 100vh;
  .sidebar__logo {
    margin: 1rem 0 2rem 1rem;
  }
  ul {
    .sidebar__link {
      position: relative;
      height: 5.6rem;
      padding: 1.5rem 0 1.5rem 1rem;
      a {
        color: var(--font-color);
        text-decoration: none;
        display: flex;
        span {
          margin-left: 2rem;
          font-size: $font-lg;
          font-weight: bold;
          .private-noti {
            font-size: $font-xs;
            color: red;
            vertical-align: text-top;
            line-height: 1;
          }
        }
      }
      .red-dot {
        position: absolute;
        left: 3rem;
      }
      a:hover {
        span {
          color: var(--main-color);
        }
        svg {
          path {
            fill: var(--main-color);
          }
        }
      }
    }
  }
  .sidebar__button {
    @extend %buttonStyle;
    height: 3.8rem;
    width: 100%;
    margin: 1.5rem 0;
    font-size: $font-lg;
  }
  &--logout {
    position: absolute;
    bottom: 0%;
    padding: 2.2rem 0 2.2rem 1rem;
    display: flex;
    cursor: pointer;
    span {
      font-size: $font-lg;
      font-weight: bold;
      margin-left: 2.3rem;
    }
    &:hover {
      span {
        color: var(--main-color);
      }
      svg {
        path {
          stroke: var(--main-color);
        }
      }
    }
  }
}
</style>
